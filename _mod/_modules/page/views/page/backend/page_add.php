<?php defined('SYSPATH') OR die('No direct access allowed.'); ?><script type="text/javascript">$(document).ready(function () {	$('#language_select').change(function() {	<?php	$prefix = array();	foreach($language_data as $row):		$img		= IMG.'languages/'.$row->file_name;		$prefix[$row->id] = $row->prefix;		?>		if($(this).val() == <?php echo $row->id; ?> && $(this).val() != 0) {			$("<?php echo '#lang_' . $row->prefix; ?>").fadeIn();			$(".flag_holder").html('<img src="<?php echo $img;?>" alt="<?php echo $row->name; ?>"/>');			} else {			$("<?php echo '#lang_' . $row->prefix; ?>").fadeOut();		}		<?php	endforeach;	?>	}).eq(0).change();});</script><h2><?php echo $module_menu; ?></h2><?php echo Form::open(ADMIN.$module_name.'/add', array(																'enctype' => 'multipart/form-data', 																'method' => 'post', 																'class' => 'general autovalid form_details',																'id' => ''																));?>	<div class="form_wrapper">	    		<fieldset>					<legend>Category Title</legend>			<div class="ls5 clear1"></div>			<?php echo sprintf($errors['title'], 'Title'); ?>			<div class="form_row">				<label>Title</label>				<input type="text" name="title" id="title_url" class="required" value="<?php echo $fields['title']; ?>" />			</div>			<?php if (isset($show_category) && $show_category) : ?>			<?php echo sprintf($errors['category_id'], 'Category'); ?>			<div class="form_row">				<label>Category</label>				<select name="category_id" id="category_id" class="required">					<option value="">&nbsp;</option>					<?php foreach ($categories as $row) : ?>					<option value="<?php echo ($row->status == 'publish') ? $row->id : '0';?>" <?php echo ($row->is_system == '1') ? 'disabled="disabled"' : '';?> <?php echo ($row->id == $fields['category_id']) ? 'selected="selected"' : ''; ?>><?php echo str_repeat('&nbsp;', $row->sub_level * 5).HTML::chars($category_data[$row->id]->subject, TRUE) . ' (' .$row->title.') ' ; ?> <?php echo ($row->status != 'publish') ? '('.$row->status.')' : ''; ?></option>					<?php endforeach; ?>				</select>			</div>			<?php else : ?>			<input type="hidden" name="category_id" id="category_id" value="<?php echo $fields['category_id']; ?>" />			<?php endif; ?>													<?php if (isset($show_publish_date) && $show_publish_date) : ?>			<?php echo sprintf($errors['publish_date'], 'Publish Date'); ?>			<div class="form_row">				<label>Publish Date</label>				<input type="text" name="publish_date" id="publish_date" value="<?php echo $fields['publish_date']; ?>" class="datepicker required" />			</div>			<?php endif; ?>			<?php if (isset($show_unpublish_date) && $show_unpublish_date) : ?>			<?php echo sprintf($errors['unpublish_date'], 'Unpublish Date'); ?>			<div class="form_row">				<label>Unpublish Date</label>				<input type="text" name="unpublish_date" id="unpublish_date" value="<?php echo $fields['unpublish_date']; ?>" class="datepicker" />			</div>			<?php endif; ?>							<?php echo sprintf($errors['show_cover'], 'Show Image Cover in Home'); ?>			<div class="form_row">				<label>Show Image Cover in Home</label>				<input type="checkbox" name="show_cover" value="1" id="show_cover" <?php echo ($fields['show_cover']) ? 'checked' :''; ?> class="" />&nbsp;&nbsp;Show			</div>			<?php echo sprintf($errors['show_image'], 'Show Image'); ?>			<div class="form_row">				<label>Show Image</label>				<input type="checkbox" name="show_image" value="1" id="show_image" <?php echo ($fields['show_image']) ? 'checked' :''; ?> class="" />&nbsp;&nbsp;Show			</div>						<div class="ls10 clear"></div>					</fieldset>					<div class="form_row clear1">			<label>Change Language&nbsp;&nbsp;</label>			<select name="language_select" id="language_select" class="">				<?php 				foreach($language_data as $flag):											$img		= IMG.'languages/'.$flag->file_name;				?>				<option value="<?php echo $flag->id;?>" <?php echo ($flag->id == 1) ? 'selected="selected"' : ''; ?>>					<?php echo $flag->name; ?>				</option>				<?php 				endforeach; 				?>			</select>			<div class="flag_holder"></div>			<span class="lang_field_err red" style="display:none">Please check other language data before submitting</span>			<div class="ls10 clear"></div>			</div>						<fieldset class="lang_content">		        <legend>Page Content</legend>		<div class="ls5 clear1"></div>		<?php 			$i=0;			foreach($language_data as $language) :				$img = IMG.'languages/'.$language->file_name;				if (!empty($detail_data[$language->id]->id) && $detail_data[$language->id]->lang_id == $language->id):				?>					<div id="lang_<?php echo $prefix[$language->id]; ?>">					<?php //echo sprintf($errors['title'], 'Title'); ?>					<div class="form_row">						<label>Subject</label>						<div class="ls2"></div>						<div class="lang_desc_row"><a class="right_float" href="javascript:void(0);" title="<?php echo $language->name; ?>">&nbsp;<img src="<?php echo $img; ?>" alt="<?php echo $language->name;?>"/>&nbsp;<?php echo $language->name; ?></a></div>						<input type="text" name="detail[<?php echo $language->id;?>][subject]" id="subject_<?php echo $detail_data[$language->id]->lang_id; ?>_<?php echo $detail_data[$language->id]->lang_id; ?>" class="required" value="<?php echo $detail_data[$language->id]->subject; ?>" />						<input type="hidden" name="detail[<?php echo $language->id;?>][id]" id="detail_id_<?php echo $detail_data[$language->id]->id; ?>" value="<?php echo $detail_data[$language->id]->id; ?>" />						<input type="hidden" name="detail[<?php echo $language->id;?>][lang_id]" id="language_id_<?php echo $language->id; ?>" value="<?php echo $language->id; ?>" />					</div>					<?php //echo sprintf($errors['description'], 'Text'); ?>					<div class="form_row">						<label>Synopsis</label>						<div class="ls2 clear1"></div>						<textarea style="vertical-align: middle; height:100px" name="detail[<?php echo $language->id;?>][synopsis]" id="synopsis_<?php echo $detail_data[$language->id]->lang_id; ?>_<?php echo $detail_data[$language->id]->lang_id; ?>" class="" rows="3"><?php echo trim($detail_data[$language->id]->synopsis); ?></textarea>					</div>											<?php //echo sprintf($errors['description'], 'Text'); ?>					<div class="form_row">						<label>Text</label>						<textarea name="detail[<?php echo $language->id;?>][text]" id="description_<?php echo $detail_data[$language->id]->lang_id; ?>_<?php echo $detail_data[$language->id]->lang_id; ?>" class="required ckeditor"><?php echo $detail_data[$language->id]->text; ?></textarea>					</div>					</div>					<?php 					else:				?>				<div id="lang_<?php echo $prefix[$language->id]; ?>">					<div class="form_row">						<label>Subject</label>						<div class="ls2"></div>						<div class="lang_desc_row"><a class="right_float" href="javascript:void(0);" title="<?php echo $language->name; ?>">&nbsp;<img src="<?php echo $img; ?>" alt="<?php echo $language->name;?>"/>&nbsp;<?php echo $language->name; ?></a></div>						<input type="text" name="detail[<?php echo $language->id;?>][subject]" id="subject_<?php echo $language->id; ?>" class="required" value="" />						<input type="hidden" name="detail[<?php echo $language->id;?>][id]" id="detail_id_<?php echo $language->id; ?>" value="<?php echo isset($detail_data[$language->id]->id) ? $detail_data[$language->id]->id : ''; ?>" />						<input type="hidden" name="detail[<?php echo $language->id;?>][lang_id]" id="language_id_<?php echo $language->id; ?>" value="<?php echo $language->id; ?>" />					</div>					<?php //echo sprintf($errors->synopsis, 'Synopsis'); ?>					<div class="form_row">						<label>Synopsis</label>						<div class="ls2 clear1"></div>						<textarea style="vertical-align: middle; height:100px" rows="3" name="detail[<?php echo $language->id;?>][synopsis]" id="synopsis_<?php echo $language->id; ?>" class=""></textarea>					</div>											<?php //echo sprintf($errors['description'], 'Text'); ?>					<div class="form_row">						<label>Text</label>						<textarea name="detail[<?php echo $language->id;?>][text]" id="description_<?php echo $language->id; ?>" class="required ckeditor"></textarea>					</div>					</div>			<?php				//endif;			endif;			$i++;		endforeach;		?>		</fieldset>				        <?php if (isset($show_publish_date) && $show_publish_date) : ?>        <?php echo sprintf($errors['publish_date'], 'Publish Date'); ?>        <div class="form_row">            <label>Publish Date</label>            <input type="text" name="publish_date" id="publish_date" value="<?php echo $fields['publish_date']; ?>" class="datepicker" />        </div>        <?php endif; ?>        <?php if (isset($show_unpublish_date) && $show_unpublish_date) : ?>        <?php echo sprintf($errors['unpublish_date'], 'Unpublish Date'); ?>        <div class="form_row">            <label>Unpublish Date</label>            <input type="text" name="unpublish_date" id="unpublish_date" value="<?php echo $fields['unpublish_date']; ?>" class="datepicker" />        </div>        <?php endif; ?>				            <?php 		if (isset($show_upload) && $show_upload) : ?>        <?php foreach ($uploads as $row_name => $row_params) : ?>            <fieldset style="clear:both;">                <legend><strong><?php echo $row_params['label']; ?></strong></legend>				<?php echo sprintf($errors[$row_name], $row_params['label']); ?>                <div class="form_row">                    <label><?php echo $row_params['label']; ?></label>                    <input type="file" name="<?php echo $row_name; ?>" id="<?php echo $row_name; ?>" />                    <?php if (isset($row_params['note']) && $row_params['note'] != '') : ?>                        <div class="form_row">                            <label>&nbsp;</label>                            <?php echo HTMl::chars($row_params['note'], TRUE); ?>                        </div>                    <?php endif; ?>                </div>                <?php if (isset($row_params['caption']) && $row_params['caption']) : ?>                <div class="form_row">                    <label>Caption</label>                    <input type="text" name="<?php echo $row_name.'_caption'; ?>" id="<?php echo $row_name.'_caption'; ?>" value="<?php echo $fields[$row_name.'_caption']; ?>" />                </div>                <?php endif; ?>    	</fieldset>        <?php endforeach; ?>        <?php endif; ?>		<?php if (isset($show_attribute) && $show_attribute) : ?>        <?php echo sprintf($errors['attribute'], 'Media'); ?>        <div class="form_row">            <label for="attribute">Media</label>            <input type="text" name="attribute" id="attribute" class="" value="<?php echo $fields['attribute']; ?>" />        </div>        <?php endif; ?>        <?php if (isset($show_allow_comment) && $show_allow_comment) : ?>        <?php echo sprintf($errors['allow_comment'], 'Allow Comment'); ?>        <div class="form_row">            <label for="allow_comment">Allow User to Comment?</label>            <input type="checkbox" name="allow_comment" id="allow_comment" value="1" <?php echo ($fields['allow_comment'] == 1) ? 'checked="checked"' : ''; ?> /> <label for="allow_comment" class="sub_label">Yes, user can comment this content</label>        </div>        <?php endif; ?>        <?php if (isset($show_tags) && $show_tags) : ?>        <?php echo sprintf($errors['tags'], 'Tags'); ?>        <div class="form_row">            <label>Tags</label>            <input type="text" name="tags" id="tags" value="<?php echo $fields['tags']; ?>" />        </div>        <?php endif; ?>        <?php if (isset($show_order) && $show_order) : ?>        <?php echo sprintf($errors['order'], 'Order'); ?>        <div class="form_row">            <label>Order</label>            <select name="order" id="order" class="required">                <option value="">&nbsp;</option>                <?php foreach ($orders as $row) : ?>                <option value="<?php echo $row->order; ?>" class="category_<?php echo $row->category_id; ?> page_<?php echo $row->id; ?>" <?php echo ($fields['order'] == ($row->order + 1)) ? 'selected="selected"' : ''; ?>><?php echo HTMl::chars($row->subject, TRUE); ?></option>                <?php endforeach; ?>            </select>        </div>        <?php endif; ?>        <?php echo sprintf($errors['status'], 'Status'); ?>        <div class="form_row">            <label>Status</label>            <select name="status" id="status" class="required">                <option value="">&nbsp;</option>                <?php foreach ($statuses as $row) : ?>                <option value="<?php echo $row; ?>" <?php echo ($fields['status'] == $row) ? 'selected="selected"' : ''; ?>><?php echo HTMl::chars(ucfirst($row), TRUE); ?></option>                <?php endforeach; ?>            </select>        </div>        <div class="form_row">            <label>&nbsp;</label>            <input type="checkbox" name="add_another" id="add_another" value="TRUE" /> <label for="add_another" class="sub_label">Add another <?php echo ucwords(str_replace('_', ' ', $module_name)); ?></label>        </div>	</div>	<div class="form_row">		<label>&nbsp;</label>		<input type="submit" class="btn_add" value="" />	</div><?php echo Form::close(); ?><?php if ($show_upload) { ?><script type="text/javascript">$(document).ready(function() {	<?php 	$i = 1;	foreach ($uploads as $pref => $val) { ?>		$('#<?php echo $pref;?>').on('change',function(){			var ext<?php echo $i;?> = $(this).val().split('.').pop().toLowerCase();			if($.inArray(ext<?php echo $i;?>, <?=json_encode((array)explode(',', $val['file_type']));?>) === -1) {				jAlert('Invalid file type (<?=$val['file_type'];?>)', 'Error');				$(this).val('');			}		});			<?php 	$i++;	} 	?>});</script><?php } ?>